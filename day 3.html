<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <!-- <script>
        // syncronous
        console.log("m")
        console.log("i")
        console.log("n")
        console.log("h")
        console.log("a")
        console.log("j")
    </script> -->
    <!-- <script>
        // Asyncronous
        console.log("i")
        console.log("eat")
        setTimeout(()=>{
            console.log("icecream")
        },2000)
        console.log("with a")
        console.log("spoon")

        
    </script> -->
    <script>
        // callback
        // function one(call_two) {
        //     call_two();

        //     console.log("step one complete. please call step 2");
        // }
        
        // function two() {
        //     console.log("step two");
        // }
        // one(two)


        // 2
        // let stocks ={
        //     fruits: ["Strewberry","Grapes","Banana","Apple"],
        //     liquid: ["Water", "ice"],
        //     holder: ["cone", "cup", "Stick"],
        //     topping: ["chocolte", "peanuts"]
        // };

        // console.log(stocks.fruits[2]);

        // let order =(call_production)=>{
        //     console.log("order placed, please call production")
        //     call_production()

        // };

        // let production =()=>{
        //     console.log("order recieved, starting production")
        // };

        // order(production)
    </script>
    <!-- <script>

        // 2 explanation
        let stocks ={
            fruits: ["Strewberry","Grapes","Banana","Apple"],
            liquid: ["Water", "ice"],
            holder: ["cone", "cup", "Stick"],
            topping: ["chocolte", "peanuts"]
        };

        

        let order =(fruit_name, call_production)=>{
            setTimeout(()=>{
                console.log(`${stocks.fruits[fruit_name]} was selected`);

                call_production()
            }, 2000)
            
            

        };

        let production =()=>{
            setTimeout(()=>{
                console.log("production has started");
                
                setTimeout(()=>{
                    console.log('the fruits has been chopped');

                    setTimeout(()=>{
                        console.log(`${stocks.liquid[0]} and ${stocks.liquid[1]} was added`);
                        setTimeout(()=>{
                            console.log("the mechine was started");
                            setTimeout(()=>{
                                console.log(`${stocks.holder[0]} was selected`);
                                setTimeout(()=>{
                                    console.log(`${stocks.topping[1]} was selected as the topping`);
                                    setTimeout(()=>{
                                        console.log("Serve icecream")
                                    },2000)
                                },2000)
                            }, 2000)
                        }, 1000)
                    },1000)
                }, 2000)
            },1000)
          
        };

        order(0 ,production);
    </script> -->
    <!-- <script>
        // Promise
        let stocks ={
            fruits: ["Strewberry","Grapes","Banana","Apple"],
            liquid: ["Water", "ice"],
            holder: ["cone", "cup", "Stick"],
            topping: ["chocolte", "peanuts"]
        };

        let is_shop_open = false;


        let order  = (time, work)=>{

            return new Promise( (resolve, reject)=>{
                if (is_shop_open) {
                    setTimeout( ()=>{
                        resolve(work())
                    },time)
                    
                }
                else{
                    reject(console.log("our shop is closed"))
                }
            } )
        }

        order(2000, ()=>console.log(`${stocks.fruits[0]} was selected`))
 
        // promise chaining
        .then(()=>{
            return order(1000, ()=> console.log("The production has started"))
        })

        .then(()=>{
            return order(2000, ()=> console.log("the fruits has chopped"))
        })

        .then(()=>{
            return order(2000, ()=> console.log(`${stocks.liquid[0]} and ${stocks.liquid[1]} has been selected`))
        })

        .then(()=>{
            return order(1000, ()=>console.log("Start the mechine"))
        })

        .then(()=>{
            return order(1000, ()=> console.log(`icecream has placed on ${stocks.holder[0]}`))
        })

        .then(()=>{
            return order(3000, ()=> console.log(`${stocks.topping[0]} was selected`))
        })

        .then(()=>{
            return order(3000, ()=> console.log("The icecream is ready to serve"))
        })

        .catch(()=>{
            console.log("Costuomer Left the shop")
        })

        .finally(()=>{
            console.log("day ended, shop is closed")
        })
    </script> -->
    <script>
        let stocks ={
            fruits: ["Strewberry","Grapes","Banana","Apple"],
            liquid: ["Water", "ice"],
            holder: ["cone", "cup", "Stick"],
            topping: ["chocolte", "peanuts"]
        };

        let is_shop_open = false;

        function time(ms) {
            return new Promise((resolve, reject)=>{
                if(is_shop_open){
                    setTimeout(resolve, ms)
                }
                else{
                    reject(console.log("the shop is closed"));
                }
            })
        }

        async function kitchen(){
            try{

                await time(2000)
                console.log(`${stocks.fruits[0]} was selected`);
                
                await time(1000)
                console.log("start the production")

                await time(2000)
                console.log("cut the fruits")

                await time(1000)
                console.log(`${stocks.liquid[1]} and ${stocks.liquid[0]} was added`)

                await time(1000)
                console.log("start the mechine")

                await time(2000)
                console.log(`icecream placed on ${stocks.holder[2]}`)

                await time(1000)
                console.log(`${stocks.topping[0]} and ${stocks.topping[1]} added as topping to your icecream`)

                await time(2000)
                console.log("your order is ready to serve")
            }
            catch(error){
                console.log("cutomer left", error)
            }
            finally{
                console.log("day ended, the shop is closed")
            }

        }
        kitchen();

    </script>
</body>
</html>